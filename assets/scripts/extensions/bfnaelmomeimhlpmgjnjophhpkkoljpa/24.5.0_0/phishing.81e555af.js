(function(define){var __define;"function"==typeof define&&define.amd&&(__define=define,define=null);
!function(){function e(e){return e&&e.__esModule?e.default:e}function t(e,t,o,n){Object.defineProperty(e,t,{get:o,set:n,enumerable:!0,configurable:!0})}var o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},r={},i=o.parcelRequire1d24;null==i&&((i=function(e){if(e in n)return n[e].exports;if(e in r){var t=r[e];delete r[e];var o={id:e,exports:{}};return n[e]=o,t.call(o.exports,o,o.exports),o.exports}var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){r[e]=t},o.parcelRequire1d24=i),i.register("6tBWY",(function(o,n){t(o.exports,"removeSubdomainFromDomain",(function(){return v}),(function(e){return v=e})),t(o.exports,"detectPhishing",(function(){return F}),(function(e){return F=e}));var r=i("7f5sb"),l=i("dX6ZT"),s=i("beWYh"),a=i("HlEsU"),c=i("csW2r"),u=i("RVqnc"),d=i("lYEke"),f=i("7XqVB"),h=i("9CoSy"),y=function(e,t,o,n){return new(o||(o=Promise))((function(r,i){function l(e){try{a(n.next(e))}catch(e){i(e)}}function s(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(l,s)}a((n=n.apply(e,t||[])).next())}))};const p=6e5,m=(f.z.object({type:f.z.union([f.z.literal("all"),f.z.literal("blocklist"),f.z.literal("whitelist"),f.z.literal("error"),f.z.literal("fuzzy"),f.z.literal("blowfishBloomFilter")]),result:f.z.boolean(),source:f.z.optional(f.z.string()),match:f.z.string().optional(),isSubdomainDomainWhitelisted:f.z.boolean().optional()}),f.z.object({localHash:f.z.any()}),f.z.object({bitVector:f.z.string(),k:f.z.number(),hash:f.z.string(),bits:f.z.number(),salt:f.z.string()})),b=f.z.union([f.z.object({bloomFilter:m,bloomFilterHash:f.z.string(),recentlyAdded:f.z.array(f.z.string()),recentlyRemoved:f.z.array(f.z.string())}),f.z.object({bloomFilter:m.optional(),bloomFilterHash:f.z.optional(f.z.string()),recentlyAdded:f.z.array(f.z.string()),recentlyRemoved:f.z.array(f.z.string())})]),g=f.z.object({bloomFilter:m,lastUpdated:f.z.number()}).nullish(),z=f.z.object({recentlyAdded:f.z.array(f.z.string()),recentlyRemoved:f.z.array(f.z.string()),lastUpdated:f.z.number().optional()}).nullish();class w{check(t,o,n){if(!t)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};const r=v(t),i=C(r);if(A(i,this.whitelist)){const e=new URL(t).hostname;if(B(C(e),this.blocklist)){const t={type:"blocklist",result:!0,source:e,isSubdomainDomainWhitelisted:!0};return o&&n.capture("blockedDomain",{data:t}),t}return{type:"whitelist",result:!1,source:e,isSubdomainDomainWhitelisted:!0}}if(B(i,this.whitelist))return{type:"whitelist",result:!1,source:r,isSubdomainDomainWhitelisted:!1};if(B(i,this.blocklist)){const e={type:"blocklist",result:!0,source:r,isSubdomainDomainWhitelisted:!1};return o&&n.capture("blockedDomain",{data:e}),e}if(this.tolerance>0){let t=D(i);t=t.replace("www.","");const o=this.fuzzylist.find((o=>{const n=D(o);return e(d).get(t,n)<=this.tolerance}));if(o){return{type:"fuzzy",result:!0,match:k(o),source:r,isSubdomainDomainWhitelisted:!1}}}return{type:"all",result:!1,source:r,isSubdomainDomainWhitelisted:!1}}constructor(e,t,o,n){this.blocklist=S(e),this.whitelist=S(t),this.fuzzylist=S(o),this.tolerance=n||3}}const v=e=>{const t=new URL(e).hostname.split(".");return t.slice(0).slice(-(4===t.length?3:2)).join(".")},S=e=>e.map(C),C=e=>e.split(".").reverse(),k=e=>e.slice().reverse().join("."),D=e=>e.slice(1).reverse().join("."),B=(e,t)=>t.some((t=>!(t.length>e.length)&&t.every(((t,o)=>e[o]===t)))),A=(e,t)=>t.some((t=>t[0]===e[0]&&t[1]===e[1]&&"*"===t[2])),F=(e,t,o)=>y(void 0,void 0,void 0,(function*(){const n=(0,l.getBlocklist)(),r=yield e.get(a.StorageKeys.CachedBlocklistDiff);let i,d,f,y=null;try{y=JSON.parse(`${r}`)}catch(e){c.telemetry.captureError(new Error(`Error parsing blocklist diff: ${null==e?void 0:e.message}`),c.FeatureTag.Generic)}try{const e=yield(0,u.withTimeout)(t.getFeatureFlags(),1e3);i=!!e["kill-blowfish-blocklist"],d=!!e["enable-blocklist-metrics"],f=!!e["enable-blocklist-blowfish-logonly"]}catch(e){i=!1,d=!0,f=!0}if(y&&y.expiresAt&&y.expiresAt>Date.now()){const r=new w(n.blocklist.concat(y.blocklist),n.whitelist.concat(y.whitelist),n.fuzzylist.concat(y.fuzzylist)).check(o,d,t);return"all"!==r.type||i?r:x(o,d,f,e,t)}{const r={},c=(0,l.getVersion)();y&&(r.lastContentHash=`${y.contentHash}`),c&&(r.localBlocklistVersion=`${c}`);const u=new(0,s.RequestClient);u.withDefaultHeaders(r);const m=yield u.get(h.PHANTOM_BLOCKLIST_URL);if(200===m.status){const r=m.data;r.expiresAt=Date.now()+p,e.set(a.StorageKeys.CachedBlocklistDiff,JSON.stringify(r));const l=new w(n.blocklist.concat(r.blocklist),n.whitelist.concat(r.whitelist),n.fuzzylist.concat(r.fuzzylist)).check(o,d,t);return"all"!=l.type||i?l:x(o,d,f,e,t)}if(304===m.status){y.expiresAt=Date.now()+p,e.set(a.StorageKeys.CachedBlocklistDiff,JSON.stringify(y));const r=new w(n.blocklist.concat(y.blocklist),n.whitelist.concat(y.whitelist),n.fuzzylist.concat(y.fuzzylist)).check(o,d,t);return"all"!=r.type||i?r:x(o,d,f,e,t)}return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1}}})),x=(e,t,o,n,i)=>y(void 0,void 0,void 0,(function*(){var l,c,u;if(!e)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};const d=v(e),f=yield n.getAll([a.StorageKeys.CachedBloomFilter,a.StorageKeys.CachedBloomFilterHash,a.StorageKeys.CachedScanDataRecents]),y=null!==(l=f[a.StorageKeys.CachedBloomFilter])&&void 0!==l?l:null,m=null!==(c=f[a.StorageKeys.CachedBloomFilterHash])&&void 0!==c?c:null,w=null!==(u=f[a.StorageKeys.CachedScanDataRecents])&&void 0!==u?u:null;let S=null,C={recentlyAdded:[],recentlyRemoved:[],lastUpdated:0};if(y){const e=g.safeParse(y);e.success?S=e.data:yield n.remove([a.StorageKeys.CachedBloomFilter,a.StorageKeys.CachedBloomFilterHash,a.StorageKeys.CachedScanDataRecents])}if(w){const e=z.safeParse(w);e.success?C=e.data:yield n.remove([a.StorageKeys.CachedBloomFilter,a.StorageKeys.CachedBloomFilterHash,a.StorageKeys.CachedScanDataRecents])}if(!C||null==C.lastUpdated||Date.now()>C.lastUpdated+p){const e={localHash:m},t=new(0,s.RequestClient),o=yield t.post(h.BLOWFISH_BLOOMFILTER_URL,e);if(200!==o.status)return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1};const r=o.data;let i;const l=b.safeParse(r);if(!l.success)return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1};i=l.data;const c={recentlyAdded:i.recentlyAdded,recentlyRemoved:i.recentlyRemoved,lastUpdated:Date.now()};if(yield n.set(a.StorageKeys.CachedScanDataRecents,c),C=c,null!=i.bloomFilter){const e={bloomFilter:i.bloomFilter,lastUpdated:Date.now()};yield Promise.all([n.set(a.StorageKeys.CachedBloomFilter,e),n.set(a.StorageKeys.CachedBloomFilterHash,i.bloomFilterHash)]),S=e}}if(!S)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};const k=(0,r.scanDomain)(S.bloomFilter,C.recentlyAdded,C.recentlyRemoved,e);if(k===r.Action.BLOCK){const e={result:!0,source:d,type:"blowfishBloomFilter"};return t&&i.capture("blockedDomain",{data:e}),o?{result:!1,type:"all",isSubdomainDomainWhitelisted:!1}:e}return k===r.Action.NONE?{result:!1,type:"all",isSubdomainDomainWhitelisted:!1}:{result:!1,type:"error",isSubdomainDomainWhitelisted:!1}}))})),i.register("7f5sb",(function(o,n){t(o.exports,"Action",(function(){return a})),t(o.exports,"scanDomain",(function(){return u}));var r=i("1LpD3"),l=i("4FfQv"),s=i("8tcqI"),a=(e=>(e.BLOCK="BLOCK",e.NONE="NONE",e))(a||{});function c(t,o){for(let n=0;n<t.k;n++){const r=e(l)(`${t.salt}_${o}_${n}`,{asBytes:!0}),i=s.Buffer.from(r).subarray(0,4).readUInt32BE(0)%t.bits,a=Math.floor(i/24),c=i%24,u=c%8;if(0==(s.Buffer.from(t.bitVector.slice(4*a,4*a+4),"base64")[Math.floor(c/8)]&1<<7-u))return!1}return!0}"undefined"!=typeof self&&self.fetch&&self.fetch;function u(e,t,o,n){const r=new URL(n).hostname.toLowerCase().split(".");for(let n=0;n<r.length-1;n++){const i=r.slice(n).join(".");if(t.includes(i))return"BLOCK";if(c(e,i)&&!o.includes(i))return"BLOCK"}return"NONE"}})),i.register("4FfQv",(function(e,t){var o,n,r,l,s=i("8tcqI").Buffer;o=i("SGO3D"),n=i("hfc1Q").utf8,r=i("hfc1Q").bin,(l=function(e,t){var i=o.wordsToBytes(function(e){e.constructor==String?e=n.stringToBytes(e):void 0!==s&&"function"==typeof s.isBuffer&&s.isBuffer(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||(e=e.toString());var t=o.bytesToWords(e),r=8*e.length,i=[],l=1732584193,a=-271733879,c=-1732584194,u=271733878,d=-1009589776;t[r>>5]|=128<<24-r%32,t[15+(r+64>>>9<<4)]=r;for(var f=0;f<t.length;f+=16){for(var h=l,y=a,p=c,m=u,b=d,g=0;g<80;g++){if(g<16)i[g]=t[f+g];else{var z=i[g-3]^i[g-8]^i[g-14]^i[g-16];i[g]=z<<1|z>>>31}var w=(l<<5|l>>>27)+d+(i[g]>>>0)+(g<20?1518500249+(a&c|~a&u):g<40?1859775393+(a^c^u):g<60?(a&c|a&u|c&u)-1894007588:(a^c^u)-899497514);d=u,u=c,c=a<<30|a>>>2,a=l,l=w}l+=h,a+=y,c+=p,u+=m,d+=b}return[l,a,c,u,d]}(e));return t&&t.asBytes?i:t&&t.asString?r.bytesToString(i):o.bytesToHex(i)})._blocksize=16,l._digestsize=20,e.exports=l})),i.register("dX6ZT",(function(e,o){var n,r;t(e.exports,"getVersion",(function(){return n}),(function(e){return n=e})),t(e.exports,"getBlocklist",(function(){return r}),(function(e){return r=e}));var l=i("hqGpV").version,s=i("3CIKc");n=()=>l,r=()=>s})),i.register("hqGpV",(function(e,t){e.exports=JSON.parse('{"name":"@phantom-labs/blocklist","version":"0.13.0","main":"index.js","types":"index.d.ts","repository":"git@github.com:phantom-labs/blocklist.git","author":"Jordan Leigh <AlwaysBCoding@gmail.com>","license":"MIT","scripts":{"build":"node build.js"},"dependencies":{"js-yaml":"^4.1.0","sha3":"^2.1.4"}}')})),i.register("3CIKc",(function(e,t){e.exports=JSON.parse('{"blocklist":["phantomweb.app","aurory.app","solvision.io","staratlas.art","starsatlas.com","sollet.cc","raydlum.io","aurorynft.com","sneks.gg","solletweb.io","i-sollet.com","fancyfrenchienft.art","solanawebwallet.online","phahtom.com","server-syncwallet.com","staratias.app","raydium.network","grapesnetwork.me","staratias.art","soistarter.org","audius-nft.top","aurory.me","degenapes.app","phantom-app.online","phantomwallet.net","dapps-node.com","phantom-app.link","solanaoutage.com","walletconnectdapps.net","staratlas.cx","web-phantom.app","0120tt.com"],"whitelist":[],"fuzzylist":[],"contentHash":"830ea1c9a833213eabc17990adf053081f503b1203ca9a2c711db7199e657293"}')})),i.register("lYEke",(function(e,t){!function(){"use strict";var o;try{o="undefined"!=typeof Intl&&void 0!==Intl.Collator?Intl.Collator("generic",{sensitivity:"base"}):null}catch(e){console.log("Collator could not be initialized and wouldn't be used")}var n=i("70tAE"),r=[],l=[],s={get:function(e,t,i){if(i&&o&&i.useCollator){var s,a,c,u,d,f,h=e.length,y=t.length;if(0===h)return y;if(0===y)return h;for(c=0;c<y;++c)r[c]=c,l[c]=t.charCodeAt(c);for(r[y]=y,c=0;c<h;++c){for(a=c+1,u=0;u<y;++u)s=a,f=0===o.compare(e.charAt(c),String.fromCharCode(l[u])),(a=r[u]+(f?0:1))>(d=s+1)&&(a=d),a>(d=r[u+1]+1)&&(a=d),r[u]=s;r[u]=a}return a}return n.distance(e,t)}};"undefined"!=typeof define&&null!==define&&define.amd?define((function(){return s})):null!==e&&e.exports===t?e.exports=s:"undefined"!=typeof self&&"function"==typeof self.postMessage&&"function"==typeof self.importScripts?self.Levenshtein=s:"undefined"!=typeof window&&null!==window&&(window.Levenshtein=s)}()})),i.register("70tAE",(function(e,o){t(e.exports,"distance",(function(){return r})),t(e.exports,"closest",(function(){return i}));const n=new Uint32Array(65536),r=(e,t)=>{if(e.length<t.length){const o=t;t=e,e=o}return 0===t.length?e.length:e.length<=32?((e,t)=>{const o=e.length,r=t.length,i=1<<o-1;let l=-1,s=0,a=o,c=o;for(;c--;)n[e.charCodeAt(c)]|=1<<c;for(c=0;c<r;c++){let e=n[t.charCodeAt(c)];const o=e|s;e|=(e&l)+l^l,s|=~(e|l),l&=e,s&i&&a++,l&i&&a--,s=s<<1|1,l=l<<1|~(o|s),s&=o}for(c=o;c--;)n[e.charCodeAt(c)]=0;return a})(e,t):((e,t)=>{const o=t.length,r=e.length,i=[],l=[],s=Math.ceil(o/32),a=Math.ceil(r/32);for(let e=0;e<s;e++)l[e]=-1,i[e]=0;let c=0;for(;c<a-1;c++){let s=0,a=-1;const u=32*c,d=Math.min(32,r)+u;for(let t=u;t<d;t++)n[e.charCodeAt(t)]|=1<<t;for(let e=0;e<o;e++){const o=n[t.charCodeAt(e)],r=l[e/32|0]>>>e&1,c=i[e/32|0]>>>e&1,u=o|s,d=((o|c)&a)+a^a|o|c;let f=s|~(d|a),h=a&d;f>>>31^r&&(l[e/32|0]^=1<<e),h>>>31^c&&(i[e/32|0]^=1<<e),f=f<<1|r,h=h<<1|c,a=h|~(u|f),s=f&u}for(let t=u;t<d;t++)n[e.charCodeAt(t)]=0}let u=0,d=-1;const f=32*c,h=Math.min(32,r-f)+f;for(let t=f;t<h;t++)n[e.charCodeAt(t)]|=1<<t;let y=r;for(let e=0;e<o;e++){const o=n[t.charCodeAt(e)],s=l[e/32|0]>>>e&1,a=i[e/32|0]>>>e&1,c=o|u,f=((o|a)&d)+d^d|o|a;let h=u|~(f|d),p=d&f;y+=h>>>r-1&1,y-=p>>>r-1&1,h>>>31^s&&(l[e/32|0]^=1<<e),p>>>31^a&&(i[e/32|0]^=1<<e),h=h<<1|s,p=p<<1|a,d=p|~(c|h),u=h&c}for(let t=f;t<h;t++)n[e.charCodeAt(t)]=0;return y})(e,t)},i=(e,t)=>{let o=1/0,n=0;for(let i=0;i<t.length;i++){const l=r(e,t[i]);l<o&&(o=l,n=i)}return t[n]}}))}();
//# sourceMappingURL=phishing.81e555af.js.map
define=__define;})(window.define);