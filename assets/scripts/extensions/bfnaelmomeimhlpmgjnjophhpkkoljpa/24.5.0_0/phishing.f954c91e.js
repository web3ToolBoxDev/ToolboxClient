(function(define){var __define;"function"==typeof define&&define.amd&&(__define=define,define=null);
function e(e,t,n,o){Object.defineProperty(e,t,{get:n,set:o,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},o={},r={},i=n.parcelRequire1d24;null==i&&((i=function(e){if(e in o)return o[e].exports;if(e in r){var t=r[e];delete r[e];var n={id:e,exports:{}};return o[e]=n,t.call(n.exports,n,n.exports),n.exports}var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){r[e]=t},n.parcelRequire1d24=i),i.register("SH3Wm",(function(e,t){!function(){var n;try{n="undefined"!=typeof Intl&&void 0!==Intl.Collator?Intl.Collator("generic",{sensitivity:"base"}):null}catch(e){console.log("Collator could not be initialized and wouldn't be used")}var o=i("g1rEU"),r=[],l=[],a={get:function(e,t,i){if(i&&n&&i.useCollator){var a,s,c,u,d,f,h=e.length,m=t.length;if(0===h)return m;if(0===m)return h;for(c=0;c<m;++c)r[c]=c,l[c]=t.charCodeAt(c);for(r[m]=m,c=0;c<h;++c){for(s=c+1,u=0;u<m;++u)a=s,f=0===n.compare(e.charAt(c),String.fromCharCode(l[u])),(s=r[u]+(f?0:1))>(d=a+1)&&(s=d),s>(d=r[u+1]+1)&&(s=d),r[u]=a;r[u]=s}return s}return o.distance(e,t)}};"undefined"!=typeof define&&null!==define&&define.amd?define((function(){return a})):null!==e&&e.exports===t?e.exports=a:"undefined"!=typeof self&&"function"==typeof self.postMessage&&"function"==typeof self.importScripts?self.Levenshtein=a:"undefined"!=typeof window&&null!==window&&(window.Levenshtein=a)}()})),i.register("g1rEU",(function(t,n){e(t.exports,"distance",(function(){return r})),e(t.exports,"closest",(function(){return i}));const o=new Uint32Array(65536),r=(e,t)=>{if(e.length<t.length){const n=t;t=e,e=n}return 0===t.length?e.length:e.length<=32?((e,t)=>{const n=e.length,r=t.length,i=1<<n-1;let l=-1,a=0,s=n,c=n;for(;c--;)o[e.charCodeAt(c)]|=1<<c;for(c=0;c<r;c++){let e=o[t.charCodeAt(c)];const n=e|a;e|=(e&l)+l^l,a|=~(e|l),l&=e,a&i&&s++,l&i&&s--,a=a<<1|1,l=l<<1|~(n|a),a&=n}for(c=n;c--;)o[e.charCodeAt(c)]=0;return s})(e,t):((e,t)=>{const n=t.length,r=e.length,i=[],l=[],a=Math.ceil(n/32),s=Math.ceil(r/32);for(let e=0;e<a;e++)l[e]=-1,i[e]=0;let c=0;for(;c<s-1;c++){let a=0,s=-1;const u=32*c,d=Math.min(32,r)+u;for(let t=u;t<d;t++)o[e.charCodeAt(t)]|=1<<t;for(let e=0;e<n;e++){const n=o[t.charCodeAt(e)],r=l[e/32|0]>>>e&1,c=i[e/32|0]>>>e&1,u=n|a,d=((n|c)&s)+s^s|n|c;let f=a|~(d|s),h=s&d;f>>>31^r&&(l[e/32|0]^=1<<e),h>>>31^c&&(i[e/32|0]^=1<<e),f=f<<1|r,h=h<<1|c,s=h|~(u|f),a=f&u}for(let t=u;t<d;t++)o[e.charCodeAt(t)]=0}let u=0,d=-1;const f=32*c,h=Math.min(32,r-f)+f;for(let t=f;t<h;t++)o[e.charCodeAt(t)]|=1<<t;let m=r;for(let e=0;e<n;e++){const n=o[t.charCodeAt(e)],a=l[e/32|0]>>>e&1,s=i[e/32|0]>>>e&1,c=n|u,f=((n|s)&d)+d^d|n|s;let h=u|~(f|d),y=d&f;m+=h>>>r-1&1,m-=y>>>r-1&1,h>>>31^a&&(l[e/32|0]^=1<<e),y>>>31^s&&(i[e/32|0]^=1<<e),h=h<<1|a,y=y<<1|s,d=y|~(c|h),u=h&c}for(let t=f;t<h;t++)o[e.charCodeAt(t)]=0;return m})(e,t)},i=(e,t)=>{let n=1/0,o=0;for(let i=0;i<t.length;i++){const l=r(e,t[i]);l<n&&(n=l,o=i)}return t[o]}}));var l=i("lDSNw");i("1KK14");var a=i("4yY1D"),s=i("dU2RF"),c=i("cZIbv"),u=(i("lDSNw"),i("aJuCi")),d={};e(d,"BlocklistOrigin",(function(){return de}),(function(e){return de=e}));var f=i("lMzyG"),h=i("1uUV4"),m=(i("lDSNw"),i("NQvFB")),y={};e(y,"removeSubdomainFromDomain",(function(){return j}),(function(e){return j=e})),e(y,"detectPhishing",(function(){return q}),(function(e){return q=e}));var g,p,b,w,v=i("6656F"),S={},z=(k=i("6rT8n")).Buffer;g=i("cfhP8"),p=i("grzf1").utf8,b=i("grzf1").bin,(w=function(e,t){var n=g.wordsToBytes(function(e){e.constructor==String?e=p.stringToBytes(e):void 0!==z&&"function"==typeof z.isBuffer&&z.isBuffer(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||(e=e.toString());var t=g.bytesToWords(e),n=8*e.length,o=[],r=1732584193,i=-271733879,l=-1732584194,a=271733878,s=-1009589776;t[n>>5]|=128<<24-n%32,t[15+(n+64>>>9<<4)]=n;for(var c=0;c<t.length;c+=16){for(var u=r,d=i,f=l,h=a,m=s,y=0;y<80;y++){if(y<16)o[y]=t[c+y];else{var b=o[y-3]^o[y-8]^o[y-14]^o[y-16];o[y]=b<<1|b>>>31}var w=(r<<5|r>>>27)+s+(o[y]>>>0)+(y<20?1518500249+(i&l|~i&a):y<40?1859775393+(i^l^a):y<60?(i&l|i&a|l&a)-1894007588:(i^l^a)-899497514);s=a,a=l,l=i<<30|i>>>2,i=r,r=w}r+=u,i+=d,l+=f,a+=h,s+=m}return[r,i,l,a,s]}(e));return t&&t.asBytes?n:t&&t.asString?b.bytesToString(n):g.bytesToHex(n)})._blocksize=16,w._digestsize=20,S=w;var k=i("6rT8n"),C=(e=>(e.BLOCK="BLOCK",e.NONE="NONE",e))(C||{});function D(e,n){for(let o=0;o<e.k;o++){const r=t(S)(`${e.salt}_${n}_${o}`,{asBytes:!0}),i=k.Buffer.from(r).subarray(0,4).readUInt32BE(0)%e.bits,l=Math.floor(i/24),a=i%24,s=a%8;if(0==(k.Buffer.from(e.bitVector.slice(4*l,4*l+4),"base64")[Math.floor(a/8)]&1<<7-s))return!1}return!0}var O,B;"undefined"!=typeof self&&self.fetch&&self.fetch;function F(e,t,n,o){const r=new URL(o).hostname.toLowerCase().split(".");for(let o=0;o<r.length-1;o++){const i=r.slice(o).join(".");if(t.includes(i))return"BLOCK";if(D(e,i)&&!n.includes(i))return"BLOCK"}return"NONE"}var K,x=JSON.parse('{"name":"@phantom-labs/blocklist","version":"0.13.0","main":"index.js","types":"index.d.ts","repository":"git@github.com:phantom-labs/blocklist.git","author":"Jordan Leigh <AlwaysBCoding@gmail.com>","license":"MIT","scripts":{"build":"node build.js"},"dependencies":{"js-yaml":"^4.1.0","sha3":"^2.1.4"}}').version;K=JSON.parse('{"blocklist":["phantomweb.app","aurory.app","solvision.io","staratlas.art","starsatlas.com","sollet.cc","raydlum.io","aurorynft.com","sneks.gg","solletweb.io","i-sollet.com","fancyfrenchienft.art","solanawebwallet.online","phahtom.com","server-syncwallet.com","staratias.app","raydium.network","grapesnetwork.me","staratias.art","soistarter.org","audius-nft.top","aurory.me","degenapes.app","phantom-app.online","phantomwallet.net","dapps-node.com","phantom-app.link","solanaoutage.com","walletconnectdapps.net","staratlas.cx","web-phantom.app","0120tt.com"],"whitelist":[],"fuzzylist":[],"contentHash":"830ea1c9a833213eabc17990adf053081f503b1203ca9a2c711db7199e657293"}');O=()=>x,B=()=>K;var E=i("8kIyR"),L=(h=i("1uUV4"),a=i("4yY1D"),i("4y59b")),T=i("SH3Wm"),U=i("7pPsM"),R=(m=i("NQvFB"),function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function l(e){try{s(o.next(e))}catch(e){i(e)}}function a(e){try{s(o.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,a)}s((o=o.apply(e,t||[])).next())}))});const A=6e5,N=(U.z.object({type:U.z.union([U.z.literal("all"),U.z.literal("blocklist"),U.z.literal("whitelist"),U.z.literal("error"),U.z.literal("fuzzy"),U.z.literal("blowfishBloomFilter")]),result:U.z.boolean(),source:U.z.optional(U.z.string()),match:U.z.string().optional(),isSubdomainDomainWhitelisted:U.z.boolean().optional()}),U.z.object({localHash:U.z.any()}),U.z.object({bitVector:U.z.string(),k:U.z.number(),hash:U.z.string(),bits:U.z.number(),salt:U.z.string()})),W=U.z.union([U.z.object({bloomFilter:N,bloomFilterHash:U.z.string(),recentlyAdded:U.z.array(U.z.string()),recentlyRemoved:U.z.array(U.z.string())}),U.z.object({bloomFilter:N.optional(),bloomFilterHash:U.z.optional(U.z.string()),recentlyAdded:U.z.array(U.z.string()),recentlyRemoved:U.z.array(U.z.string())})]),I=U.z.object({bloomFilter:N,lastUpdated:U.z.number()}).nullish(),H=U.z.object({recentlyAdded:U.z.array(U.z.string()),recentlyRemoved:U.z.array(U.z.string()),lastUpdated:U.z.number().optional()}).nullish();class P{check(e,n,o){if(!e)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};const r=j(e),i=_(r);if(V(i,this.whitelist)){const t=new URL(e).hostname;if(G(_(t),this.blocklist)){const e={type:"blocklist",result:!0,source:t,isSubdomainDomainWhitelisted:!0};return n&&o.capture("blockedDomain",{data:e}),e}return{type:"whitelist",result:!1,source:t,isSubdomainDomainWhitelisted:!0}}if(G(i,this.whitelist))return{type:"whitelist",result:!1,source:r,isSubdomainDomainWhitelisted:!1};if(G(i,this.blocklist)){const e={type:"blocklist",result:!0,source:r,isSubdomainDomainWhitelisted:!1};return n&&o.capture("blockedDomain",{data:e}),e}if(this.tolerance>0){let e=J(i);e=e.replace("www.","");const n=this.fuzzylist.find((n=>{const o=J(n);return t(T).get(e,o)<=this.tolerance}));if(n){return{type:"fuzzy",result:!0,match:$(n),source:r,isSubdomainDomainWhitelisted:!1}}}return{type:"all",result:!1,source:r,isSubdomainDomainWhitelisted:!1}}constructor(e,t,n,o){this.blocklist=M(e),this.whitelist=M(t),this.fuzzylist=M(n),this.tolerance=o||3}}const j=e=>{const t=new URL(e).hostname.split(".");return t.slice(0).slice(-(4===t.length?3:2)).join(".")},M=e=>e.map(_),_=e=>e.split(".").reverse(),$=e=>e.slice().reverse().join("."),J=e=>e.slice(1).reverse().join("."),G=(e,t)=>t.some((t=>!(t.length>e.length)&&t.every(((t,n)=>e[n]===t)))),V=(e,t)=>t.some((t=>t[0]===e[0]&&t[1]===e[1]&&"*"===t[2])),q=(e,t,n)=>R(void 0,void 0,void 0,(function*(){const o=B(),r=yield e.get(h.StorageKeys.CachedBlocklistDiff);let i,l,s,c=null;try{c=JSON.parse(`${r}`)}catch(e){a.telemetry.captureError(new Error(`Error parsing blocklist diff: ${null==e?void 0:e.message}`),a.FeatureTag.Generic)}try{const e=yield(0,L.withTimeout)(t.getFeatureFlags(),1e3);i=!!e["kill-blowfish-blocklist"],l=!!e["enable-blocklist-metrics"],s=!!e["enable-blocklist-blowfish-logonly"]}catch(e){i=!1,l=!0,s=!0}if(c&&c.expiresAt&&c.expiresAt>Date.now()){const r=new P(o.blocklist.concat(c.blocklist),o.whitelist.concat(c.whitelist),o.fuzzylist.concat(c.fuzzylist)).check(n,l,t);return"all"!==r.type||i?r:Y(n,l,s,e,t)}{const r={},a=O();c&&(r.lastContentHash=`${c.contentHash}`),a&&(r.localBlocklistVersion=`${a}`);const u=new(0,E.RequestClient);u.withDefaultHeaders(r);const d=yield u.get(m.PHANTOM_BLOCKLIST_URL);if(200===d.status){const r=d.data;r.expiresAt=Date.now()+A,e.set(h.StorageKeys.CachedBlocklistDiff,JSON.stringify(r));const a=new P(o.blocklist.concat(r.blocklist),o.whitelist.concat(r.whitelist),o.fuzzylist.concat(r.fuzzylist)).check(n,l,t);return"all"!=a.type||i?a:Y(n,l,s,e,t)}if(304===d.status){c.expiresAt=Date.now()+A,e.set(h.StorageKeys.CachedBlocklistDiff,JSON.stringify(c));const r=new P(o.blocklist.concat(c.blocklist),o.whitelist.concat(c.whitelist),o.fuzzylist.concat(c.fuzzylist)).check(n,l,t);return"all"!=r.type||i?r:Y(n,l,s,e,t)}return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1}}})),Y=(e,t,n,o,r)=>R(void 0,void 0,void 0,(function*(){var i,l,a;if(!e)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};const s=j(e),c=yield o.getAll([h.StorageKeys.CachedBloomFilter,h.StorageKeys.CachedBloomFilterHash,h.StorageKeys.CachedScanDataRecents]),u=null!==(i=c[h.StorageKeys.CachedBloomFilter])&&void 0!==i?i:null,d=null!==(l=c[h.StorageKeys.CachedBloomFilterHash])&&void 0!==l?l:null,f=null!==(a=c[h.StorageKeys.CachedScanDataRecents])&&void 0!==a?a:null;let y=null,g={recentlyAdded:[],recentlyRemoved:[],lastUpdated:0};if(u){const e=I.safeParse(u);e.success?y=e.data:yield o.remove([h.StorageKeys.CachedBloomFilter,h.StorageKeys.CachedBloomFilterHash,h.StorageKeys.CachedScanDataRecents])}if(f){const e=H.safeParse(f);e.success?g=e.data:yield o.remove([h.StorageKeys.CachedBloomFilter,h.StorageKeys.CachedBloomFilterHash,h.StorageKeys.CachedScanDataRecents])}if(!g||null==g.lastUpdated||Date.now()>g.lastUpdated+A){const e={localHash:d},t=new(0,E.RequestClient),n=yield t.post(m.BLOWFISH_BLOOMFILTER_URL,e);if(200!==n.status)return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1};const r=n.data;let i;const l=W.safeParse(r);if(!l.success)return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1};i=l.data;const a={recentlyAdded:i.recentlyAdded,recentlyRemoved:i.recentlyRemoved,lastUpdated:Date.now()};if(yield o.set(h.StorageKeys.CachedScanDataRecents,a),g=a,null!=i.bloomFilter){const e={bloomFilter:i.bloomFilter,lastUpdated:Date.now()};yield Promise.all([o.set(h.StorageKeys.CachedBloomFilter,e),o.set(h.StorageKeys.CachedBloomFilterHash,i.bloomFilterHash)]),y=e}}if(!y)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};const p=F(y.bloomFilter,g.recentlyAdded,g.recentlyRemoved,e);if(p===C.BLOCK){const e={result:!0,source:s,type:"blowfishBloomFilter"};return t&&r.capture("blockedDomain",{data:e}),n?{result:!1,type:"all",isSubdomainDomainWhitelisted:!1}:e}return p===C.NONE?{result:!1,type:"all",isSubdomainDomainWhitelisted:!1}:{result:!1,type:"error",isSubdomainDomainWhitelisted:!1}}));c=i("cZIbv");var Q=i("hvlNY"),Z=i("aanFI"),X={};e(X,"PTrans",(function(){return ne}),(function(e){return ne=e}));f=i("lMzyG"),l=i("lDSNw");var ee=i("kBpKb"),te=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n};const ne=t(l).memo((e=>{const{children:n,i18nKey:o}=e,r=te(e,["children","i18nKey"]),{t:i}=(0,f.useTranslation)(),a=(0,l.useMemo)((()=>(o?`${i(o,Object.assign(Object.assign({},r),r.values))}`:"").replace(/<\/?[^>]+(>|$)/g,"")),[o,r,i]);return t(l).createElement(ee.ErrorBoundary,{fallback:a},t(l).createElement(f.Trans,Object.assign({i18nKey:o},r),n))}));var oe=i("kn91D"),re=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function l(e){try{s(o.next(e))}catch(e){i(e)}}function a(e){try{s(o.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,a)}s((o=o.apply(e,t||[])).next())}))};const ie="#ca3214",le=c.default.div`
  position: fixed;
  top: 0;
  left: 0;
  height: 100%;
  width: 100%;
  background-color: #fffdf8;
  padding: clamp(24px, 16vh, 256px) 24px;
  box-sizing: border-box;
`,ae=c.default.div`
  margin-bottom: 24px;
  padding-bottom: 8vh;
`,se=c.default.div`
  max-width: 100ch;
  margin: auto;

  * {
    text-align: left;
  }
`,ce=c.default.a`
  text-decoration: underline;
  color: ${ie};
`,ue=new(0,Q.LocalStorage),de=({origin:e,subdomain:n})=>{const{t:o}=(0,f.useTranslation)(),r=e?(0,y.removeSubdomainFromDomain)(e):"",i=new URL(null!=e?e:"").hostname,a="true"===n?i:r;return t(l).createElement(le,null,t(l).createElement(se,null,t(l).createElement(ae,null,t(l).createElement(Z.IconPhantomWordmark,{width:128,fill:"#bbb9b6"})),t(l).createElement(oe.Text,{size:30,color:ie,weight:"600"},o("blocklistOriginDomainIsBlocked",{domainName:a||o("blocklistOriginThisDomain")})),t(l).createElement(oe.Text,{color:ie},o("blocklistOriginSiteIsMalicious")),t(l).createElement(oe.Text,{color:ie},t(l).createElement(X.PTrans,{i18nKey:"blocklistOriginCommunityDatabaseInterpolated"},"This site has been flagged as part of a",t(l).createElement(ce,{href:m.PHANTOM_BLOCKLIST_GITHUB_URL,rel:"noopener",target:"_blank"},"community-maintained database"),"of known phishing websites and scams. If you believe the site has been flagged in error,",t(l).createElement(ce,{href:m.PHANTOM_BLOCKLIST_GITHUB_URL,rel:"noopener",target:"_blank"},"please file an issue"),".")),a?t(l).createElement(oe.Text,{color:ie,onClick:()=>re(void 0,void 0,void 0,(function*(){if("true"===n){const e=yield ue.get(h.StorageKeys.UserWhitelistSubdomains);let t=JSON.parse(`${e}`);t?t.push(i):t=[i],t=[...new Set(t)],ue.set(h.StorageKeys.UserWhitelistSubdomains,JSON.stringify(t))}else{const e=yield ue.get(h.StorageKeys.UserWhitelistedOrigins);let t=JSON.parse(`${e}`);t?t.push(r):t=[r],t=[...new Set(t)],ue.set(h.StorageKeys.UserWhitelistedOrigins,JSON.stringify(t))}window.location.href=e})),hoverUnderline:!0},o("blocklistOriginIgnoreWarning",{domainName:e})):t(l).createElement(t(l).Fragment,null)))};ee=i("kBpKb");const fe=()=>{let e;try{e=new URLSearchParams(window.location.search).get("origin")||"",new URL(e)}catch(t){e=""}return e},he=()=>new URLSearchParams(window.location.search).get("subdomain")||"";var me=i("a8kcR"),ye=i("h5kyv"),ge=i("8DCD7"),pe=i("bLLpR");a.fileLogger.init({provider:pe.ClientFileLoggerProvider}),a.telemetry.init(),a.telemetry.setUser({id:ye.analytics.getDeviceId()}),(0,ge.initializeFeatureFlags)();const be=document.getElementById("root");(0,s.createRoot)(be).render(t(l).createElement(c.ThemeProvider,{theme:me.theme},t(l).createElement((()=>{const e=(0,l.useMemo)(fe,[]),n=(0,l.useMemo)(he,[]);return t(l).createElement(u.MemoryRouter,{future:{v7_startTransition:!0}},t(l).createElement(ee.ErrorBoundaryWithDefaultFallback,null,t(l).createElement(d.BlocklistOrigin,{origin:e,subdomain:n})))}),null)));
//# sourceMappingURL=phishing.f954c91e.js.map
define=__define;})(window.define);